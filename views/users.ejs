<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('partials/head') %>
</head>
<body>
    <!-- Sidebar -->
    <%- include('partials/sidebar') %>

    <!-- Main Content -->
    <main class="main-content">
        <div class="page-content">
            <div class="page-header">
                <div>
                    <h1 class="page-title">Users Management</h1>
                    <p class="page-description">Create and manage user accounts</p>
                </div>
                <button class="btn btn-primary" id="addUserBtn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" width="18" height="18">
                        <line x1="12" y1="5" x2="12" y2="19"/>
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                    Add User
                </button>
            </div>

            <!-- Users Table -->
            <div class="content-section">
                <div class="table-container">
                    <table class="data-table" id="usersTable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Status</th>
                                <th>Created Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <!-- Users will be populated here -->
                        </tbody>
                    </table>

                    <!-- Empty State -->
                    <div id="emptyState" class="empty-state" style="display: none;">
                        <div class="empty-icon">üë•</div>
                        <h3>No Users Yet</h3>
                        <p>Create your first user to get started</p>
                        <button class="btn btn-primary" onclick="document.getElementById('addUserBtn').click()">
                            Add First User
                        </button>
                    </div>

                    <!-- Loading State -->
                    <div id="loadingState" class="loading-state">
                        <div class="spinner"></div>
                        <p>Loading users...</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Add/Edit User Modal -->
    <div id="userModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Add New User</h2>
                <button class="modal-close" onclick="closeUserModal()">&times;</button>
            </div>

            <form id="userForm">
                <div class="modal-body">
                    <div class="form-group">
                        <label for="userName">
                            Name <span class="required">*</span>
                        </label>
                        <input
                            type="text"
                            id="userName"
                            name="name"
                            placeholder="Enter user's full name"
                            required
                        >
                        <small class="help-text">User's display name</small>
                    </div>

                    <div class="form-group">
                        <label for="userEmail">
                            Email <span class="required">*</span>
                        </label>
                        <input
                            type="email"
                            id="userEmail"
                            name="email"
                            placeholder="user@example.com"
                            required
                        >
                        <small class="help-text">User's email address (must be unique)</small>
                    </div>

                    <div class="form-group">
                        <label for="userStatus">
                            Status <span class="required">*</span>
                        </label>
                        <select id="userStatus" name="status" required>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                        </select>
                        <small class="help-text">User account status</small>
                    </div>

                    <input type="hidden" id="userId" name="userId">
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeUserModal()">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary" id="saveUserBtn">
                        <span id="saveButtonText">Create User</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>Confirm Delete</h2>
                <button class="modal-close" onclick="closeDeleteModal()">&times;</button>
            </div>

            <div class="modal-body">
                <p>Are you sure you want to delete this user?</p>
                <p class="warning-text">‚ö†Ô∏è This action cannot be undone. All user connections will also be affected.</p>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeDeleteModal()">
                    Cancel
                </button>
                <button type="button" class="btn btn-danger" onclick="confirmDelete()">
                    Delete User
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <script src="/js/users.js"></script>
</body>
</html>
